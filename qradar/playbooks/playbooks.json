{
  "type": "workflow_collections",
  "data": [
    {
      "@context": "/api/3/contexts/WorkflowCollection",
      "@type": "WorkflowCollection",
      "name": "Sample - IBM QRadar - 1.6.0",
      "description": "Sample playbooks for \"IBM QRadar\" connector. If you are planning to use any of the sample playbooks in your environment, ensure that you clone those playbooks and move them to a different collection, since the sample playbook collection gets deleted during connector upgrade and delete.",
      "visible": true,
      "image": "/api/3/images/8282d33e-04d2-4a12-b999-14e372ee3c13",
      "id": 98,
      "createDate": 1674804803.080613,
      "modifyDate": 1674804803.080613,
      "deletedAt": null,
      "importedBy": [],
      "recordTags": [
        "qradar"
      ],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Close Offense",
          "aliasName": null,
          "tag": "#qradar",
          "description": "Closes an offense on the QRadar server based on the offense ID that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/60cb8a08-4609-46ec-a6d7-930d3c28ecd1",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Close Offense",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "offense_id": null,
                  "closure_note": null,
                  "offense_close_id": null
                },
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "close_offense",
                "operationTitle": "Close Offense",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "23f10b54-7569-4822-9f1c-95570f6eb660"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "269ab8c6-1172-4fb7-a23d-7f5dcdf44861",
                "title": "IBM QRadar: Close Offense",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "60cb8a08-4609-46ec-a6d7-930d3c28ecd1"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Close Offense",
              "targetStep": "/api/3/workflow_steps/23f10b54-7569-4822-9f1c-95570f6eb660",
              "sourceStep": "/api/3/workflow_steps/60cb8a08-4609-46ec-a6d7-930d3c28ecd1",
              "label": null,
              "isExecuted": false,
              "uuid": "21e72086-bf63-4db4-8b0b-0ea47fd4b4f6"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "007d4c06-3d2f-4e01-8dc7-bda2ed2e6174",
          "id": 1220,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Make an Ariel Query to QRadar",
          "aliasName": null,
          "tag": "#qradar",
          "description": "Executes an Ariel query on the QRadar server. QRadar uses the Ariel Query Language (AQL) to search for offenses or events based on query parameters.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/f071bd04-09f0-499e-a89a-a6157737fcbd",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Make an Ariel Query to QRadar",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "search_string": null
                },
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "query_qradar",
                "operationTitle": "Make an Ariel Query to QRadar",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "db6cd8b7-20ec-49ac-b9ef-304be5755524"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "b5cce0db-e88a-4790-8c35-7aec2c84fc64",
                "title": "IBM QRadar: Make an Ariel Query to QRadar",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "f071bd04-09f0-499e-a89a-a6157737fcbd"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Make an Ariel Query to QRadar",
              "targetStep": "/api/3/workflow_steps/db6cd8b7-20ec-49ac-b9ef-304be5755524",
              "sourceStep": "/api/3/workflow_steps/f071bd04-09f0-499e-a89a-a6157737fcbd",
              "label": null,
              "isExecuted": false,
              "uuid": "11a511af-8f73-4d23-be28-cf8499687549"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "00ffefc0-2b93-428c-a118-a90df2b98067",
          "id": 1216,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Events Related to an Offense",
          "aliasName": null,
          "tag": "#qradar",
          "description": "Retrieves details of events associated with a QRadar offense, from the QRadar server, based on the QRadar offense ID that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/96c9ae16-e0a0-4ac9-bbcc-248d352b8207",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Events Related to an Offense",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "offense_id": "",
                  "start_time": "",
                  "max_results": 100,
                  "last_updated_time": ""
                },
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "get_events_related_to_offense",
                "operationTitle": "Get Events Related to an Offense",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "94ed3708-62f5-491c-ab4b-7873ef8b3000"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "9ab9c608-da3c-494b-a2ae-f2dd6beeff41",
                "title": "IBM QRadar: Get Events Related to an Offense",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "96c9ae16-e0a0-4ac9-bbcc-248d352b8207"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Events Related to an Offense",
              "targetStep": "/api/3/workflow_steps/94ed3708-62f5-491c-ab4b-7873ef8b3000",
              "sourceStep": "/api/3/workflow_steps/96c9ae16-e0a0-4ac9-bbcc-248d352b8207",
              "label": null,
              "isExecuted": false,
              "uuid": "377707b6-919b-4ea7-b106-11a126e088ea"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "0877e980-6d9f-44eb-a1df-7442b0d1cbf3",
          "id": 1222,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Create Note",
          "aliasName": null,
          "tag": "#qradar",
          "description": "Creates a note for a specified offense in QRadar based on the offense ID you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/c8607748-119b-426a-876b-578363f698a5",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Create Note",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "offense_id": null,
                  "closure_note": null
                },
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "add_notes",
                "operationTitle": "Create Note",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "93e7ab1b-1dcd-4e8d-9e98-27b541f88359"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "6e1a4e87-66fb-4618-b437-f1c5440068df",
                "title": "IBM QRadar: Create Note",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "c8607748-119b-426a-876b-578363f698a5"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Create Note",
              "targetStep": "/api/3/workflow_steps/93e7ab1b-1dcd-4e8d-9e98-27b541f88359",
              "sourceStep": "/api/3/workflow_steps/c8607748-119b-426a-876b-578363f698a5",
              "label": null,
              "isExecuted": false,
              "uuid": "f1d1b9b1-6f0c-4827-adcf-a3ec7a616786"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "0b539f97-8ab0-47cc-8921-d8b82b7849c6",
          "id": 1221,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": ">> IBM QRadar > Init Macros",
          "aliasName": null,
          "tag": "#qradar #dataingestion",
          "description": "This playbook creates IBM QRadar macros if not exist.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "QRadarMacroName",
            "QRadarMacroValue",
            "overrideIfNoMatch"
          ],
          "synchronous": false,
          "lastModifyDate": 1674804960,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/7e14cbed-6f8a-4b64-8c65-592ff8e6ef46",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get QRadar Macros",
              "description": null,
              "arguments": {
                "name": "Utilities",
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?format=json&name={{vars.QRadarMacroName}}",
                  "body": "",
                  "method": "GET"
                },
                "version": "2.5.0",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "CyOPs: Make CyOPs API Call",
                "step_variables": []
              },
              "status": null,
              "top": "120",
              "left": "171",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "1e3a42d8-62cc-4c08-8684-a5f3090dab7e"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create IBM QRadar Macro",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?format=json",
                  "body": "{ 'name': '{{vars.QRadarMacroName}}'   , 'value': '{{vars.QRadarMacroValue}}' }",
                  "method": "POST"
                },
                "version": "2.5.0",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "CyOPs: Make CyOPs API Call",
                "step_variables": []
              },
              "status": null,
              "top": "306",
              "left": "651",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "343a9c5e-4726-462d-8b6e-9536f38b1ae1"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Macro If Required",
              "description": null,
              "arguments": {
                "when": "{{(vars.input.params.overrideIfNoMatch  == true) and (vars.macroExistingRecord.value != vars.QRadarMacroValue)}}",
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/{{ vars.macroExistingRecord.id }}/",
                  "body": "{ 'name': '{{vars.QRadarMacroName}}'   , 'value': '{{vars.QRadarMacroValue}}' }",
                  "method": "PUT"
                },
                "version": "2.7.0",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "CyOPs: Make CyOPs API Call",
                "step_variables": []
              },
              "status": null,
              "top": "147",
              "left": "952",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "446da6db-6848-4f5b-ae48-d3d77cd44bb2"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Macro Current Value",
              "description": null,
              "arguments": {
                "macroExistingRecord": "{{vars.steps.Get_QRadar_Macros.data['hydra:member'][0]}}"
              },
              "status": null,
              "top": "147",
              "left": "651",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "5927d5c8-80a7-40ba-a328-1063cfd040b1"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": {
                      "QRadarMacroName": "{{ vars.QRadarMacroName }}",
                      "QRadarMacroValue": "{{ vars.QRadarMacroValue }}",
                      "overrideIfNoMatch": "{{ vars.overrideIfNoMatch }}"
                    }
                  }
                }
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "7e14cbed-6f8a-4b64-8c65-592ff8e6ef46"
            },
            {
              "@type": "WorkflowStep",
              "name": "QRadar Macro Exists",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Not Exist",
                    "step_iri": "/api/3/workflow_steps/343a9c5e-4726-462d-8b6e-9536f38b1ae1",
                    "condition": "{{ vars.steps.Get_QRadar_Macros.data['hydra:totalItems'] == 0 }}"
                  },
                  {
                    "option": "Exist",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/5927d5c8-80a7-40ba-a328-1063cfd040b1"
                  }
                ]
              },
              "status": null,
              "top": "228",
              "left": "320",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "group": null,
              "uuid": "eaf99c78-1fdf-4889-b7c2-23cddf3df3b4"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "QRadar Macro Exists -> Fetch Macro Current Value",
              "targetStep": "/api/3/workflow_steps/5927d5c8-80a7-40ba-a328-1063cfd040b1",
              "sourceStep": "/api/3/workflow_steps/eaf99c78-1fdf-4889-b7c2-23cddf3df3b4",
              "label": "Exist",
              "isExecuted": false,
              "uuid": "00dcd616-220b-469e-9d23-aa66d153e710"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get All Macros -> Check IBM QRadar Macro",
              "targetStep": "/api/3/workflow_steps/eaf99c78-1fdf-4889-b7c2-23cddf3df3b4",
              "sourceStep": "/api/3/workflow_steps/1e3a42d8-62cc-4c08-8684-a5f3090dab7e",
              "label": null,
              "isExecuted": false,
              "uuid": "68e55f01-1db0-40bf-a335-d80f53d76219"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Check IBM QRadar Macro -> Create IBM QRadar Macro",
              "targetStep": "/api/3/workflow_steps/343a9c5e-4726-462d-8b6e-9536f38b1ae1",
              "sourceStep": "/api/3/workflow_steps/eaf99c78-1fdf-4889-b7c2-23cddf3df3b4",
              "label": "Not Exist",
              "isExecuted": false,
              "uuid": "a7af5a44-14c5-4630-9d65-dafbca37292e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get All Macros",
              "targetStep": "/api/3/workflow_steps/1e3a42d8-62cc-4c08-8684-a5f3090dab7e",
              "sourceStep": "/api/3/workflow_steps/7e14cbed-6f8a-4b64-8c65-592ff8e6ef46",
              "label": null,
              "isExecuted": false,
              "uuid": "a881159f-e7da-47aa-b70c-3c697a9ccafe"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Macro Current Value -> Update Macro If Required",
              "targetStep": "/api/3/workflow_steps/446da6db-6848-4f5b-ae48-d3d77cd44bb2",
              "sourceStep": "/api/3/workflow_steps/5927d5c8-80a7-40ba-a328-1063cfd040b1",
              "label": null,
              "isExecuted": false,
              "uuid": "fb10b8ab-4948-4fa1-9e8e-9e0527f2e8b0"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "125de419-d680-40fd-a037-4e1472678650",
          "id": 1240,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Assets",
          "aliasName": null,
          "tag": "#qradar",
          "description": "Retrieves a detailed list of available assets from Qradar based on input parameters specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/6ef5097a-5d0a-4c9c-a4fb-dd156a6ded58",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "c434036d-c904-4d3e-a6f6-b8315f228c11",
                "title": "IBM QRadar: Get Assets",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "6ef5097a-5d0a-4c9c-a4fb-dd156a6ded58"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Assets",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "max_results": 100,
                  "filter_string": ""
                },
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "get_assets",
                "operationTitle": "Get Assets",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "e07664b0-b020-4d36-8366-4d8c6f2a3b18"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Assets",
              "targetStep": "/api/3/workflow_steps/e07664b0-b020-4d36-8366-4d8c6f2a3b18",
              "sourceStep": "/api/3/workflow_steps/6ef5097a-5d0a-4c9c-a4fb-dd156a6ded58",
              "label": null,
              "isExecuted": false,
              "uuid": "7d5c465a-97a5-48eb-a791-7bff99d2ae9e"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "1ea43cab-a77a-4235-9e38-af38ffbb2eef",
          "id": 1228,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Manipulate Reference Set Content",
          "aliasName": null,
          "tag": "#qradar",
          "description": "Adds or deletes the content that you have specified from a specified reference set on QRadar.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/3b49e6ca-9bbe-4c1d-bc8e-738b637dc45a",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "10bf29dc-e028-48a8-a2a8-5605baeb5f50",
                "title": "IBM QRadar: Manipulate Reference Set Content",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "3b49e6ca-9bbe-4c1d-bc8e-738b637dc45a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Manipulate Reference Set Content",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "method": "Retrieves Value"
                },
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "handle_reference_set_value",
                "operationTitle": "Manipulate Reference Set Content",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "6c90da17-f516-4725-b677-cf6100f22ec2"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Manipulate Reference Set Content",
              "targetStep": "/api/3/workflow_steps/6c90da17-f516-4725-b677-cf6100f22ec2",
              "sourceStep": "/api/3/workflow_steps/3b49e6ca-9bbe-4c1d-bc8e-738b637dc45a",
              "label": null,
              "isExecuted": false,
              "uuid": "0db40522-b1ca-46ab-95f1-e87f1b3b99d3"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "27ab4a12-0f40-4862-abb9-fc7a2b6864d1",
          "id": 1226,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Source IP Addresses",
          "aliasName": null,
          "tag": "#qradar",
          "description": "Retrieves IP address details associated with a source address IDs from the QRadar server, based on the source address IDs that you have specified",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/2d59d217-940c-4b62-9d55-5b97ccc118ba",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "f3011451-3328-4f1f-80e6-e12b734b453c",
                "title": "IBM QRadar: Get Source IP Addresses",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "2d59d217-940c-4b62-9d55-5b97ccc118ba"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Source IP Addresses",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": [],
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "get_source_ip",
                "operationTitle": "Get Source IP Addresses",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "fe47e2be-3fe6-4126-980f-d3550502aea9"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Source IP Addresses",
              "targetStep": "/api/3/workflow_steps/fe47e2be-3fe6-4126-980f-d3550502aea9",
              "sourceStep": "/api/3/workflow_steps/2d59d217-940c-4b62-9d55-5b97ccc118ba",
              "label": null,
              "isExecuted": false,
              "uuid": "11a2e6b7-de2f-4d68-807c-4789df8760e2"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "2cec3289-35e8-4789-8513-97d85dfe5540",
          "id": 1223,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> IBM QRadar > Fetch",
          "aliasName": null,
          "tag": "#qradar #fetch #dataingestion",
          "description": "This playbook fetches the Offenses.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1674804960,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/ad310072-7fea-43cc-b439-a8645eaaf887",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Source Address Details",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "when": "{{(vars.all_offenses | length > 0) and (vars.src_ips | length > 0)}}",
                "config": "",
                "params": {
                  "source_address_ids": "{{vars.src_ips}}"
                },
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "get_source_ip",
                "operationTitle": "Get Source IP Addresses",
                "step_variables": []
              },
              "status": null,
              "top": "1080",
              "left": "1040",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "281ea8e8-a14d-42c7-b738-c614bf0f3c33"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "macro_name": "{{vars['audit_info']['cyops_playbook_iri'].split('/')[-1].replace('-','_')}}",
                "filter_string": "status=\"OPEN\"",
                "qradar_timezone": "UTC",
                "event_record_limit": "50",
                "Pull_Sample_Offense_in_Past_X_Minutes": "10"
              },
              "status": null,
              "top": "180",
              "left": "80",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "38a23149-50b7-46dc-bc85-e66bb3504ced"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Macro List",
              "description": null,
              "arguments": {
                "macro_list": "[{\"macro_name\": \"QRadarLastOffensePullTime_{{vars.macro_name}}\" , \"macro_value\": 0, \"override\": false},{\"macro_name\": \"QRadarTimeZone_{{vars.macro_name}}\" , \"macro_value\": \"{{vars.qradar_timezone}}\", \"override\": true},{\"macro_name\": \"QRadarEventLimit_{{vars.macro_name}}\" , \"macro_value\": \"{{vars.event_record_limit}}\", \"override\": true}]"
              },
              "status": null,
              "top": "280",
              "left": "80",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "3afff17e-d499-4113-af82-b835af3fa3fe"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Offenses With IP Details",
              "description": null,
              "arguments": {
                "_dummy_for_src_addrs": "{% for each_offense in vars.all_offenses %}\n {% set offense_src_ips = [] %}\n {% for each_ip in vars.steps.Get_Source_Address_Details.data %}\n {% if each_ip.id in each_offense.source_address_ids %}\n {% set _temp =  offense_src_ips.append(each_ip) %}\n {% endif %}\n{% endfor %}\n{% set _temp2 = each_offense.update({\"source_address_details\": offense_src_ips}) %}\n {% endfor %}",
                "_dummy_for_dest_addrs": "{% for each_offense in vars.all_offenses %}\n {% set offense_dest_ips = [] %}\n {% for each_ip in vars.steps.Get_Destination_Address_Details.data %}\n {% if each_ip.id in each_offense.local_destination_address_ids %}\n {% set _temp =  offense_dest_ips.append(each_ip) %}\n{% endif %}\n{% endfor %}\n{% set _temp2 = each_offense.update({\"destination_address_details\": offense_dest_ips}) %}\n {% endfor %}"
              },
              "status": null,
              "top": "1320",
              "left": "1040",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "41f695a7-6b08-4f7c-9ffe-7ecb997da07a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Time Configuration",
              "description": null,
              "arguments": {
                "curr_timestamp": "{{arrow.utcnow().int_timestamp}}",
                "last_pull_time": "{% if (vars.steps.Get_Macro_Value.data[\"hydra:member\"] | length) > 0 and vars.steps.Get_Macro_Value.data[\"hydra:member\"][0].value | int  > 0 %}{{vars.steps.Get_Macro_Value.data[\"hydra:member\"][0].value}}{% else %}{{ (arrow.utcnow().int_timestamp) - (vars.Pull_Sample_Offense_in_Past_X_Minutes| int)  *60 }}{% endif %}"
              },
              "status": null,
              "top": "520",
              "left": "480",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "83711d66-d948-48d8-a9e5-eb2ae2ee5783"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Destination Address Details",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "when": "{{(vars.all_offenses | length > 0) and (vars.destinations_ips | length > 0)}}",
                "config": "",
                "params": {
                  "destination_address_ids": "{{vars.destinations_ips}}"
                },
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "get_destination_ip",
                "operationTitle": "Get Destination IP Addresses",
                "step_variables": []
              },
              "status": null,
              "top": "1200",
              "left": "1040",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "92bb6478-a77d-41d6-a7f9-e25ae31417fe"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Result",
              "description": null,
              "arguments": {
                "data": "{{vars.all_offenses}}",
                "curr_timestamp": "{{vars.curr_timestamp}}",
                "QRadarLimitMacro": "{{vars.macro_list[2].get(\"macro_value\")}}",
                "QRadarPullTimeMacro": "{{vars.macro_list[0].get(\"macro_name\")}}",
                "QRadarTimeZoneMacro": "{{vars.macro_list[1].get(\"macro_value\")}}"
              },
              "status": null,
              "top": "1460",
              "left": "1040",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "94094387-566e-47fa-876a-783e77b3fb34"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Macro Value",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?name={{vars.macro_list[0].get(\"macro_name\")}}",
                  "body": "",
                  "method": "GET"
                },
                "version": "3.2.1",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "400",
              "left": "480",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "972412dc-a37c-4faa-a9ca-9202ac204ffe"
            },
            {
              "@type": "WorkflowStep",
              "name": "Calculate Diff in min",
              "description": null,
              "arguments": {
                "time_diff_min": "{{ (vars.curr_timestamp - vars.last_pull_time) / 60 | round }}"
              },
              "status": null,
              "top": "620",
              "left": "680",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "9fdd7a32-f71f-46fa-afcc-3bb0db52d427"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  },
                  "_configuration_schema": "[{\n\t\t\"title\": \"Search Query\",\n\t\t\"tooltip\": \"The Query to be run on QRadar to fetch offenses\",\n\t\t\"required\": true,\n\t\t\"editable\": true,\n\t\t\"visible\": true,\n\t\t\"type\": \"text\",\n\t\t\"name\": \"filter_string\",\n\t\t\"value\": \"status=\\\"OPEN\\\"\"\n\t}, {\n\t\t\"title\": \"Pull Offenses in the last X minutes\",\n\t\t\"tooltip\": \"Limit the search query specified above to filter the offenses created or modified in the last X minutes\",\n\t\t\"required\": true,\n\t\t\"editable\": true,\n\t\t\"visible\": true,\n\t\t\"type\": \"text\",\n\t\t\"name\": \"Pull_Sample_Offense_in_Past_X_Minutes\",\n\t\t\"value\": 10\n\n\t},\n\t{\n\t\t\"title\": \"Timezone of the QRadar server\",\n\t\t\"tooltip\": \"Required for the time conversion to pull events since the last X minutes for an offense\",\n\t\t\"required\": true,\n\t\t\"editable\": true,\n\t\t\"visible\": true,\n\t\t\"type\": \"text\",\n\t\t\"name\": \"qradar_timezone\",\n\t\t\"value\": \"UTC\"\n\n\t},\n\t{\n\t\t\"title\": \"Event Record Limit\",\n\t\t\"tooltip\": \"Pull number of events for an offense\",\n\t\t\"required\": true,\n\t\t\"editable\": true,\n\t\t\"visible\": true,\n\t\t\"type\": \"integer\",\n\t\t\"name\": \"event_record_limit\",\n\t\t\"value\": 50\n\t}\n]"
                }
              },
              "status": null,
              "top": "60",
              "left": "80",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "ad310072-7fea-43cc-b439-a8645eaaf887"
            },
            {
              "@type": "WorkflowStep",
              "name": "Collect IP ids",
              "description": null,
              "arguments": {
                "src_ips": "{{ vars.steps.Get_Offenses.data | json_query('[*].source_address_ids[]') }}",
                "destinations_ips": "{{ vars.steps.Get_Offenses.data | json_query('[*].local_destination_address_ids[]') }}"
              },
              "status": null,
              "top": "980",
              "left": "840",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "ad37fd6b-63b3-45ed-a0d8-36d61ef24b34"
            },
            {
              "@type": "WorkflowStep",
              "name": "Environment Setup",
              "description": null,
              "arguments": {
                "when": "{{vars.request.env_setup}}",
                "for_each": {
                  "item": "{{vars.macro_list}}",
                  "__bulk": false,
                  "parallel": true,
                  "condition": ""
                },
                "arguments": {
                  "QRadarMacroName": "{{vars.item.macro_name}}",
                  "QRadarMacroValue": "{{vars.item.macro_value}}",
                  "overrideIfNoMatch": "{{vars.item.override}}"
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/125de419-d680-40fd-a037-4e1472678650"
              },
              "status": null,
              "top": "280",
              "left": "480",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "d4d6c7c3-c602-4423-b735-ca1bdcae1a56"
            },
            {
              "@type": "WorkflowStep",
              "name": "Calculate QRadar Epoch Time",
              "description": null,
              "arguments": {
                "qradar_epoch": "{{ ( arrow.get(vars.curr_timestamp).shift(minutes=-vars.time_diff_min).int_timestamp) * 1000}}"
              },
              "status": null,
              "top": "760",
              "left": "680",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "d9b639a6-9249-4e91-8610-b6746c0667d3"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Offenses",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "",
                "params": {
                  "filter_string": "{{vars.filter_string}} and (start_time > '{{vars.qradar_epoch}}' or last_updated_time > '{{vars.qradar_epoch}}' )"
                },
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "get_offenses",
                "operationTitle": "Get Offenses from QRadar",
                "step_variables": {
                  "all_offenses": "{{ vars.result.data }}"
                }
              },
              "status": null,
              "top": "860",
              "left": "840",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "e7c959c5-6c1c-46be-a648-4f68d65f103d"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Create Macro List -> Create QRadar Last Offense Pull Time Macro",
              "targetStep": "/api/3/workflow_steps/d4d6c7c3-c602-4423-b735-ca1bdcae1a56",
              "sourceStep": "/api/3/workflow_steps/3afff17e-d499-4113-af82-b835af3fa3fe",
              "label": null,
              "isExecuted": false,
              "uuid": "2cec1ffd-60a6-4a16-b85f-ee7708040265"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create QRadar Last Offense Pull Time Macro -> Get Macro Value",
              "targetStep": "/api/3/workflow_steps/972412dc-a37c-4faa-a9ca-9202ac204ffe",
              "sourceStep": "/api/3/workflow_steps/d4d6c7c3-c602-4423-b735-ca1bdcae1a56",
              "label": null,
              "isExecuted": false,
              "uuid": "348cdbc0-89cf-4591-b22f-4d88ddfbe2f6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Copy of Configuration",
              "targetStep": "/api/3/workflow_steps/3afff17e-d499-4113-af82-b835af3fa3fe",
              "sourceStep": "/api/3/workflow_steps/38a23149-50b7-46dc-bc85-e66bb3504ced",
              "label": null,
              "isExecuted": false,
              "uuid": "4e68d135-5bd6-437e-896c-2a4e03821831"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Time Configuration -> Calculate Diff in min",
              "targetStep": "/api/3/workflow_steps/9fdd7a32-f71f-46fa-afcc-3bb0db52d427",
              "sourceStep": "/api/3/workflow_steps/83711d66-d948-48d8-a9e5-eb2ae2ee5783",
              "label": null,
              "isExecuted": false,
              "uuid": "4f31c5d8-6a84-41dc-93b6-a34e0dae1894"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Calculate QRadar Epoch Time -> Get Offenses",
              "targetStep": "/api/3/workflow_steps/e7c959c5-6c1c-46be-a648-4f68d65f103d",
              "sourceStep": "/api/3/workflow_steps/d9b639a6-9249-4e91-8610-b6746c0667d3",
              "label": null,
              "isExecuted": false,
              "uuid": "5151afc9-d066-45f9-a88c-e564fefd4062"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Update Offenses With IP Details -> Set Result",
              "targetStep": "/api/3/workflow_steps/94094387-566e-47fa-876a-783e77b3fb34",
              "sourceStep": "/api/3/workflow_steps/41f695a7-6b08-4f7c-9ffe-7ecb997da07a",
              "label": null,
              "isExecuted": false,
              "uuid": "55260454-05e9-4120-9db8-6a5bffa240fb"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Offenses -> Collect IP ids",
              "targetStep": "/api/3/workflow_steps/ad37fd6b-63b3-45ed-a0d8-36d61ef24b34",
              "sourceStep": "/api/3/workflow_steps/e7c959c5-6c1c-46be-a648-4f68d65f103d",
              "label": null,
              "isExecuted": false,
              "uuid": "5ca17733-a419-4a79-b5c9-6ef1edff0c7f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Destination Address Details -> Update Offenses With IP Details",
              "targetStep": "/api/3/workflow_steps/41f695a7-6b08-4f7c-9ffe-7ecb997da07a",
              "sourceStep": "/api/3/workflow_steps/92bb6478-a77d-41d6-a7f9-e25ae31417fe",
              "label": null,
              "isExecuted": false,
              "uuid": "840b1a66-aeba-4837-b81e-8e0dcef49f98"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/38a23149-50b7-46dc-bc85-e66bb3504ced",
              "sourceStep": "/api/3/workflow_steps/ad310072-7fea-43cc-b439-a8645eaaf887",
              "label": null,
              "isExecuted": false,
              "uuid": "a9519062-613c-4d68-8f7f-33a298938906"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Macro Value -> Set Time Configuration",
              "targetStep": "/api/3/workflow_steps/83711d66-d948-48d8-a9e5-eb2ae2ee5783",
              "sourceStep": "/api/3/workflow_steps/972412dc-a37c-4faa-a9ca-9202ac204ffe",
              "label": null,
              "isExecuted": false,
              "uuid": "b58038fb-b2da-4b59-9d88-868cdd59093b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Collect IP ids -> Get Source IP Details",
              "targetStep": "/api/3/workflow_steps/281ea8e8-a14d-42c7-b738-c614bf0f3c33",
              "sourceStep": "/api/3/workflow_steps/ad37fd6b-63b3-45ed-a0d8-36d61ef24b34",
              "label": null,
              "isExecuted": false,
              "uuid": "cc9328f6-8acb-4bcc-940a-9e304d5c00db"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Calculate Diff in min -> Calculate QRadar Epoch Time",
              "targetStep": "/api/3/workflow_steps/d9b639a6-9249-4e91-8610-b6746c0667d3",
              "sourceStep": "/api/3/workflow_steps/9fdd7a32-f71f-46fa-afcc-3bb0db52d427",
              "label": null,
              "isExecuted": false,
              "uuid": "e71ba3d3-f4ff-431a-a3b1-b938f44a0558"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Source IP Details -> Get Destination Address Details",
              "targetStep": "/api/3/workflow_steps/92bb6478-a77d-41d6-a7f9-e25ae31417fe",
              "sourceStep": "/api/3/workflow_steps/281ea8e8-a14d-42c7-b738-c614bf0f3c33",
              "label": null,
              "isExecuted": false,
              "uuid": "f0900f7e-2167-4c8d-b8b8-acef3a171dff"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "395d1deb-8b02-44bd-946e-567c19e94c4d",
          "id": 1241,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "fetch",
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Add/Update Table Element",
          "aliasName": null,
          "tag": "#qradar",
          "description": "Specify the element to add or update in the reference table on Qradar based on the input parameters specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/d5cf4b9e-6c12-4ac6-b2ca-ffdea179f9d9",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Add/Update Table Element",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "path.name": "",
                  "query.value": "",
                  "query.source": "FortiSOAR",
                  "query.domain_id": "",
                  "query.inner_key": "",
                  "query.outer_key": ""
                },
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "add_table_element",
                "operationTitle": "Add/Update Table Element",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "8be91fc9-c7f0-4176-a352-4f062a096c10"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "8694d2d7-80e3-4736-9e20-8bee669f12d3",
                "title": "IBM QRadar: Add/Update Table Element",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "d5cf4b9e-6c12-4ac6-b2ca-ffdea179f9d9"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Add/Update Table Element",
              "targetStep": "/api/3/workflow_steps/8be91fc9-c7f0-4176-a352-4f062a096c10",
              "sourceStep": "/api/3/workflow_steps/d5cf4b9e-6c12-4ac6-b2ca-ffdea179f9d9",
              "label": null,
              "isExecuted": false,
              "uuid": "9c571b2b-6512-4a8c-9197-fcc4769f6485"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "3f2bcb60-8b10-43a5-83a7-864d43c1cf2c",
          "id": 1235,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Update Asset",
          "aliasName": null,
          "tag": "#qradar",
          "description": "Updates the attributes of a specific asset on the Qradar server based on the asset ID that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/4c7ddebe-d069-40d8-a6f6-f9c22c972b4d",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "1073af3c-83fb-4c6c-8cd7-517cb94a52e6",
                "title": "IBM QRadar: Update Asset",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "4c7ddebe-d069-40d8-a6f6-f9c22c972b4d"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Asset",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "body.asset": "",
                  "content_type": "text/plain",
                  "path.asset_id": ""
                },
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "update_asset",
                "operationTitle": "Update Asset",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "cc86edb3-d6a4-45c3-9ea0-23a70851e063"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Update Asset",
              "targetStep": "/api/3/workflow_steps/cc86edb3-d6a4-45c3-9ea0-23a70851e063",
              "sourceStep": "/api/3/workflow_steps/4c7ddebe-d069-40d8-a6f6-f9c22c972b4d",
              "label": null,
              "isExecuted": false,
              "uuid": "206311ff-573f-41b8-b713-baad6ae95550"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "47f96d0b-12ac-4f50-8632-5d0034159a49",
          "id": 1229,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "API - Push Offense From QRadar",
          "aliasName": null,
          "tag": "#qradar app",
          "description": "This playbook demonstrate the QRadar App. You need have QRadar CyberSponse App installed on QRadar.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1674804960,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/240b911e-4943-4767-adab-f9ce9b73cd67",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "qradar",
                "authentication_methods": [
                  ""
                ]
              },
              "status": null,
              "top": "53",
              "left": "234",
              "stepType": "/api/3/workflow_step_types/df26c7a2-4166-4ca5-91e5-548e24c01b5f",
              "group": null,
              "uuid": "240b911e-4943-4767-adab-f9ce9b73cd67"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Offense Details",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "",
                "params": {
                  "filter_string": "id={{ vars.request.data.Offense_ID }}"
                },
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "get_offenses",
                "operationTitle": "Get Offenses from QRadar",
                "step_variables": []
              },
              "status": null,
              "top": "160",
              "left": "400",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "cc2bcdd0-6d2e-44da-b678-b651ac7268dd"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Get Offense Details",
              "targetStep": "/api/3/workflow_steps/cc2bcdd0-6d2e-44da-b678-b651ac7268dd",
              "sourceStep": "/api/3/workflow_steps/240b911e-4943-4767-adab-f9ce9b73cd67",
              "label": null,
              "isExecuted": false,
              "uuid": "e6ae8dda-ac20-49eb-a647-90e2f3fe7973"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "4bab766d-5f84-417b-bb42-b10b9a60da3d",
          "id": 1238,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar app"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> IBM QRadar > Create Alert",
          "aliasName": null,
          "tag": "#qradar #dataingestion #create",
          "description": "This playbook creates the offense as an alert in CyOPs.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "sourcedata",
            "qradar_pull_time"
          ],
          "synchronous": false,
          "lastModifyDate": 1674804960,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/454586c7-0c8a-4f09-8ff7-82497d7938ff",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Create Record",
              "description": null,
              "arguments": {
                "resource": {
                  "name": "{{vars.sourcedata['description']}}",
                  "type": "/api/3/picklists/574a6ee2-7265-4701-815e-cff83b053bce",
                  "state": "/api/3/picklists/a1bac09b-1441-45aa-ad1b-c88744e48e72",
                  "source": "QRadar",
                  "status": "{{ vars.sourcedata[\"status\"]  | resolveRange(vars.alerts_status_map)}}",
                  "comments": "[\"{{vars.steps.Add_a_note_of_offense_update['@id']}}\"]",
                  "severity": "{{ vars.sourcedata[\"severity\"]  | resolveRange(vars.alerts_severity_map)}}",
                  "sourceId": "{{vars.sourcedata['id']}}",
                  "__replace": "true",
                  "sourcedata": "{{vars.offense_data | toJSON }}",
                  "description": "<p>{% if vars.sourcedata.source_address_details | length !=0 %}</p>\n<p>{{ vars.sourcedata.source_address_details | json2html }}</p>\n<p>{% endif %}{% if vars.sourcedata.destination_address_details | length != 0 %}</p>\n<p>{{ vars.sourcedata.destination_address_details | json2html }}</p>\n<p>{% endif %}</p>",
                  "ackSlaStatus": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                  "respSlaStatus": "/api/3/picklists/72979f64-e8b9-4888-a965-957e0ec24818",
                  "priorityWeight": 1,
                  "escalatedtoincident": "/api/3/picklists/2128a09c-153d-4db3-985d-de6be33deae5",
                  "alertRemainingAckSLA": 0
                },
                "_showJson": false,
                "is_upsert": true,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/alerts",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "320",
              "left": "560",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "group": null,
              "uuid": "1a9489db-2fd2-4024-a686-b3ac816c04c8"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": {
                      "sourcedata": "{{ vars.sourcedata }}",
                      "qradar_pull_time": "{{ vars.qradar_pull_time }}"
                    }
                  }
                }
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "454586c7-0c8a-4f09-8ff7-82497d7938ff"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "offense_data": "{ 'offense_data':  {{vars.input.params.sourcedata}},\n'events_data': []\n}",
                "alerts_status_map": "{'OPEN': {{'AlertStatus'| picklist('Open') }}, 'CLOSED': {{'AlertStatus'| picklist('Closed') }}}",
                "alerts_severity_map": "{'1,2': {{'Severity'| picklist('Minimal') }}, '3,4': {{'Severity'| picklist('Low') }}, '5,6': {{'Severity'| picklist('Medium') }}, '7,8': {{'Severity'| picklist('High') }}, '9,10': {{'Severity'| picklist('Critical') }}}"
              },
              "status": null,
              "top": "100",
              "left": "220",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "89c7a044-81fe-45ba-9ef3-aa31d81ac3e7"
            },
            {
              "@type": "WorkflowStep",
              "name": "Add a note of offense update",
              "description": null,
              "arguments": {
                "when": "{{vars.sourcedata.start_time > ((vars.input.params['qradar_pull_time']| int)*1000) or vars.sourcedata.last_updated_time > ((vars.input.params['qradar_pull_time']| int)*1000)}}",
                "resource": {
                  "type": "/api/3/picklists/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                  "people": [],
                  "content": "<p>Below is the latest summary:</p>\n<p>status: {{vars.sourcedata.status}}<br />inactive: {{vars.sourcedata.inactive}}<br />severity: {{vars.sourcedata.severity}}<br />magnitude: {{vars.sourcedata.magnitude}}<br />relevance: {{vars.sourcedata.relevance}}<br />categories: {{vars.sourcedata.categories}}<br />assigned_to: {{vars.sourcedata.assigned_to}}<br />event_count: {{vars.sourcedata.event_count}}<br />closing_user: {{vars.sourcedata.closing_user}}<br />offense_type: {{vars.sourcedata.offense_type}}</p>",
                  "__replace": "",
                  "isImportant": false,
                  "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/comments",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "200",
              "left": "380",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "group": null,
              "uuid": "df25a446-1780-46b5-adef-e9051e4b453f"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Add a note of offense update",
              "targetStep": "/api/3/workflow_steps/df25a446-1780-46b5-adef-e9051e4b453f",
              "sourceStep": "/api/3/workflow_steps/89c7a044-81fe-45ba-9ef3-aa31d81ac3e7",
              "label": null,
              "isExecuted": false,
              "uuid": "0ae25e1c-e6fd-432d-94ef-cfbb23fd3507"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Add a note of offense update -> Create Record",
              "targetStep": "/api/3/workflow_steps/1a9489db-2fd2-4024-a686-b3ac816c04c8",
              "sourceStep": "/api/3/workflow_steps/df25a446-1780-46b5-adef-e9051e4b453f",
              "label": null,
              "isExecuted": false,
              "uuid": "2ef5dead-248c-4b80-ac5f-68db312b65c2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/89c7a044-81fe-45ba-9ef3-aa31d81ac3e7",
              "sourceStep": "/api/3/workflow_steps/454586c7-0c8a-4f09-8ff7-82497d7938ff",
              "label": null,
              "isExecuted": false,
              "uuid": "a4ed676e-e6d1-429a-b641-c02f6182f385"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "543c12a4-5e88-4ff4-9dd6-fc3fe84e85bf",
          "id": 1242,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "create",
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Offense Types",
          "aliasName": null,
          "tag": "#qradar",
          "description": "Retrieves a list containing IDs of all the offense types from the QRadar server.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/6feafba2-9936-410e-bed0-5ca197622167",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "3f1b012a-c149-4973-a686-7894d388f97a",
                "title": "IBM QRadar: Get Offense Types",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "6feafba2-9936-410e-bed0-5ca197622167"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Offense Types",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": [],
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "get_offense_type",
                "operationTitle": "Get Offense Types",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "8f67294e-22e7-467c-a2a8-b739ccdb67b7"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Offense Types",
              "targetStep": "/api/3/workflow_steps/8f67294e-22e7-467c-a2a8-b739ccdb67b7",
              "sourceStep": "/api/3/workflow_steps/6feafba2-9936-410e-bed0-5ca197622167",
              "label": null,
              "isExecuted": false,
              "uuid": "a8647bbd-f5e0-4128-aad0-3591415ca2be"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "55d88305-35e9-419e-b53d-66a588edcccb",
          "id": 1218,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Offense Closing Reasons",
          "aliasName": null,
          "tag": "#qradar",
          "description": "Retrieves a list of closing reasons associated with all offenses from the QRadar server.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/1ddf0b94-a39a-4248-bd1b-f4e8bd957a09",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "14f204e0-35e3-45f3-8c93-a0c1d182ded4",
                "title": "IBM QRadar: Get Offense Closing Reasons",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "1ddf0b94-a39a-4248-bd1b-f4e8bd957a09"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Offense Closing Reasons",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": [],
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "get_closing_reasons",
                "operationTitle": "Get Offense Closing Reasons",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "ded06946-14a2-4788-8af8-0b38d76d9069"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Offense Closing Reasons",
              "targetStep": "/api/3/workflow_steps/ded06946-14a2-4788-8af8-0b38d76d9069",
              "sourceStep": "/api/3/workflow_steps/1ddf0b94-a39a-4248-bd1b-f4e8bd957a09",
              "label": null,
              "isExecuted": false,
              "uuid": "f258ff26-2f64-48e9-8023-3b25d47b62a0"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "6f24a6c8-7b42-4213-a057-dcedc0a5d5b4",
          "id": 1217,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Delete Table Element",
          "aliasName": null,
          "tag": "#qradar",
          "description": "Specify the element to be deleted from a reference table on Qradar based on input parameters specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/e1d262ae-8a8f-4b00-907c-d6aa776e8bfe",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Delete Table Element",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "path.name": "",
                  "query.value": "",
                  "query.source": "FortiSOAR",
                  "path.inner_key": "",
                  "path.outer_key": "",
                  "query.domain_id": ""
                },
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "delete_table_element",
                "operationTitle": "Delete Table Element",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "9649b930-306c-4192-9c69-4ebc9ab05319"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "b9cc3a93-f1cc-43e9-b436-94470403e808",
                "title": "IBM QRadar: Delete Table Element",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "e1d262ae-8a8f-4b00-907c-d6aa776e8bfe"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Delete Table Element",
              "targetStep": "/api/3/workflow_steps/9649b930-306c-4192-9c69-4ebc9ab05319",
              "sourceStep": "/api/3/workflow_steps/e1d262ae-8a8f-4b00-907c-d6aa776e8bfe",
              "label": null,
              "isExecuted": false,
              "uuid": "ca4116ad-39c9-4707-ab78-64286f73c58f"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "70ad4891-c26c-46e2-ba1d-c152c2d9fd9b",
          "id": 1236,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Destination IP Addresses",
          "aliasName": null,
          "tag": "#qradar",
          "description": "Retrieves IP address details associated with a destination address IDs from the QRadar server, based on the destination address IDs that you have specified",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/2db2adf3-67d6-4b15-8a82-4beca3fa5c18",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "40ef23ce-e46b-4df7-9103-63d255393d6a",
                "title": "IBM QRadar: Get Destination IP Addresses",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "2db2adf3-67d6-4b15-8a82-4beca3fa5c18"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Destination IP Addresses",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": [],
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "get_destination_ip",
                "operationTitle": "Get Destination IP Addresses",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "40518057-3fbc-47a5-bc55-cb03b28d9ebc"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Destination IP Addresses",
              "targetStep": "/api/3/workflow_steps/40518057-3fbc-47a5-bc55-cb03b28d9ebc",
              "sourceStep": "/api/3/workflow_steps/2db2adf3-67d6-4b15-8a82-4beca3fa5c18",
              "label": null,
              "isExecuted": false,
              "uuid": "2ceeadf9-15a3-4a12-bdbc-15db76b34c85"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "73dec9ca-c55e-4ae6-8a77-7d032918ff7b",
          "id": 1224,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Create Case",
          "aliasName": null,
          "tag": "#qradar",
          "description": "Create a new case on Qradar",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/d1cc21b0-0d09-4418-99e2-96905b554b0b",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Create Case",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "body.case": "",
                  "content_type": "application/json"
                },
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "create_case",
                "operationTitle": "Create Case",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "0116b577-c3ba-46b4-9c39-24418ccd99d7"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "65647444-65e1-47b7-8cd4-40095d9e3b9f",
                "title": "IBM QRadar: Create Case",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "d1cc21b0-0d09-4418-99e2-96905b554b0b"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Create Case",
              "targetStep": "/api/3/workflow_steps/0116b577-c3ba-46b4-9c39-24418ccd99d7",
              "sourceStep": "/api/3/workflow_steps/d1cc21b0-0d09-4418-99e2-96905b554b0b",
              "label": null,
              "isExecuted": false,
              "uuid": "d2380c29-28f0-44d8-b69c-caa27cda5667"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "7b208ac6-4d0a-4b7e-8b35-62f0d875dda8",
          "id": 1231,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Offense Notes",
          "aliasName": null,
          "tag": "#qradar",
          "description": "Retrieves a list of notes associated with a specified offense in QRadar based on the offense ID you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/4a4917a6-6d01-4ac1-b4ab-17e9e9eb06b1",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Offense Notes",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "offense_id": null
                },
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "get_notes",
                "operationTitle": "Get Offense Notes",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "145c94b6-45e4-4be1-a144-7bb2b2f1c8f8"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "070fc90d-097f-4075-a5af-90faf7bd2874",
                "title": "IBM QRadar: Get Offense Notes",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "4a4917a6-6d01-4ac1-b4ab-17e9e9eb06b1"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Offense Notes",
              "targetStep": "/api/3/workflow_steps/145c94b6-45e4-4be1-a144-7bb2b2f1c8f8",
              "sourceStep": "/api/3/workflow_steps/4a4917a6-6d01-4ac1-b4ab-17e9e9eb06b1",
              "label": null,
              "isExecuted": false,
              "uuid": "4f7fcb60-f659-4b2f-91c3-271740f25caf"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "85e8997e-89d2-46e7-8821-40d5d664f0ae",
          "id": 1219,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "IBM QRadar > Ingest",
          "aliasName": null,
          "tag": "#qradar #ingest #dataingestion",
          "description": "This playbook demonstrates Get Offense Operation.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1674804960,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/082d1b51-a6d2-47cf-a430-81acf4e8e319",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "a28d0464-7811-41c1-abfb-a610c09da724",
                "title": "QRadar > Fetch Offenses Now",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records}}"
                  }
                },
                "displayConditions": {
                  "alerts": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  },
                  "incidents": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": []
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "082d1b51-a6d2-47cf-a430-81acf4e8e319"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "qradar_timezone": "{{vars.steps.Fetch_Offenses.QRadarTimeZoneMacro}}",
                "qradar_pull_time": "{{vars.steps.Fetch_Offenses.QRadarPullTimeMacro}}",
                "qradar_event_limit": "{{vars.steps.Fetch_Offenses.QRadarLimitMacro}}"
              },
              "status": null,
              "top": "260",
              "left": "400",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "27c90d89-47b7-460e-9f9a-0df7dcb9fe17"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Offenses",
              "description": null,
              "arguments": {
                "arguments": [],
                "step_variables": [],
                "workflowReference": "/api/3/workflows/395d1deb-8b02-44bd-946e-567c19e94c4d"
              },
              "status": null,
              "top": "140",
              "left": "240",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "693ed537-789c-4eae-a560-5b8a54435d8e"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Alert",
              "description": null,
              "arguments": {
                "when": "{{( vars.steps.Fetch_Offenses.data!= None) and ( vars.steps.Fetch_Offenses.data| length > 0)}}",
                "for_each": {
                  "item": "{{ vars.steps.Fetch_Offenses.data}}",
                  "parallel": false,
                  "condition": ""
                },
                "arguments": {
                  "sourcedata": "{{vars.item}}",
                  "qradar_pull_time": "{{vars.qradar_pull_time}}"
                },
                "apply_async": false,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/543c12a4-5e88-4ff4-9dd6-fc3fe84e85bf"
              },
              "status": null,
              "top": "360",
              "left": "700",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "77315a12-69d9-4198-9a68-3da733a5f1a5"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Last Offense Pull Time",
              "description": null,
              "arguments": {
                "name": "Utilities",
                "params": {
                  "macro": "{{vars.qradar_pull_time}}",
                  "value": "{{ vars.steps.Fetch_Offenses.curr_timestamp}}"
                },
                "version": "3.2.1",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "CyOPs: Update Macro",
                "step_variables": []
              },
              "status": null,
              "top": "440",
              "left": "1020",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "bc4f27cf-e402-4df5-84b4-64183ffa4fcd"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Related Events of Offense",
              "description": null,
              "arguments": {
                "when": "{{vars.steps.Create_Alert}}",
                "for_each": {
                  "item": "{{vars.steps.Create_Alert}}",
                  "parallel": false,
                  "condition": ""
                },
                "arguments": {
                  "alertRecord": "{{vars.item}}",
                  "qradar_timezone": "{{vars.qradar_timezone}}",
                  "qradar_event_limit": "{{vars.qradar_event_limit}}"
                },
                "apply_async": true,
                "step_variables": [],
                "workflowReference": "/api/3/workflows/fb724aae-4f4c-4bf5-a95b-f7eef4a80f61"
              },
              "status": null,
              "top": "520",
              "left": "1340",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "d21b8a09-d683-4df5-933a-3996b726833f"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Offenses -> Configuration",
              "targetStep": "/api/3/workflow_steps/27c90d89-47b7-460e-9f9a-0df7dcb9fe17",
              "sourceStep": "/api/3/workflow_steps/693ed537-789c-4eae-a560-5b8a54435d8e",
              "label": null,
              "isExecuted": false,
              "uuid": "2dfec012-7d52-48a3-ac75-270736a869bf"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Create Alert",
              "targetStep": "/api/3/workflow_steps/77315a12-69d9-4198-9a68-3da733a5f1a5",
              "sourceStep": "/api/3/workflow_steps/27c90d89-47b7-460e-9f9a-0df7dcb9fe17",
              "label": null,
              "isExecuted": false,
              "uuid": "354ed8ad-0113-466c-bdfd-6a1ff89dc58f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Fetch Offenses",
              "targetStep": "/api/3/workflow_steps/693ed537-789c-4eae-a560-5b8a54435d8e",
              "sourceStep": "/api/3/workflow_steps/082d1b51-a6d2-47cf-a430-81acf4e8e319",
              "label": null,
              "isExecuted": false,
              "uuid": "5e1893af-19be-4339-83e6-349441994b0d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Update Last Offense Pull Time -> Fetch Related Events of Offense",
              "targetStep": "/api/3/workflow_steps/d21b8a09-d683-4df5-933a-3996b726833f",
              "sourceStep": "/api/3/workflow_steps/bc4f27cf-e402-4df5-84b4-64183ffa4fcd",
              "label": null,
              "isExecuted": false,
              "uuid": "67bcb88b-53bf-409d-9744-931a3948979a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Alert -> Update Last Offense Pull Time",
              "targetStep": "/api/3/workflow_steps/bc4f27cf-e402-4df5-84b4-64183ffa4fcd",
              "sourceStep": "/api/3/workflow_steps/77315a12-69d9-4198-9a68-3da733a5f1a5",
              "label": null,
              "isExecuted": false,
              "uuid": "6822dcad-383b-4d3c-8cce-f3f714bf7941"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "886c42d5-f519-405c-a015-b4599bc6e248",
          "id": 1239,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "ingest",
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Offenses from QRadar",
          "aliasName": null,
          "tag": "#qradar",
          "description": "Retrieves a list of offenses from the QRadar server based on the filter string that you have specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/12dcaefc-c645-4558-99cb-77f3ef8fb6b2",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "18e457bd-9451-4acb-965a-5810e7dff310",
                "title": "IBM QRadar: Get Offenses from QRadar",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "12dcaefc-c645-4558-99cb-77f3ef8fb6b2"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Offenses from QRadar",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "filter_string": ""
                },
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "get_offenses",
                "operationTitle": "Get Offenses from QRadar",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "5c26b262-be87-4da5-b72d-31e7c3c1f1c5"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Offenses from QRadar",
              "targetStep": "/api/3/workflow_steps/5c26b262-be87-4da5-b72d-31e7c3c1f1c5",
              "sourceStep": "/api/3/workflow_steps/12dcaefc-c645-4558-99cb-77f3ef8fb6b2",
              "label": null,
              "isExecuted": false,
              "uuid": "9f8b1a20-30dc-40f5-a8f6-8c6791f13c81"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "8ca6b3fa-9cc0-4642-9518-85ea8b1b02c4",
          "id": 1215,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Assets Properties",
          "aliasName": null,
          "tag": "#qradar",
          "description": "Retrieves a detailed list of available asset properties from Qradar that can be used with assets update operation.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/7b8d0ff9-9da8-4f7e-93f7-4206fd3ac356",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "1d2495cd-dc20-4608-a261-2ae20e3715bb",
                "title": "IBM QRadar: Get Assets Properties",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "7b8d0ff9-9da8-4f7e-93f7-4206fd3ac356"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Assets Properties",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "max_results": 100
                },
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "get_assets_properties",
                "operationTitle": "Get Assets Properties",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "87ab17bf-199c-4bba-86e4-00c1bef49549"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Assets Properties",
              "targetStep": "/api/3/workflow_steps/87ab17bf-199c-4bba-86e4-00c1bef49549",
              "sourceStep": "/api/3/workflow_steps/7b8d0ff9-9da8-4f7e-93f7-4206fd3ac356",
              "label": null,
              "isExecuted": false,
              "uuid": "98442db0-fc53-4df8-a050-d339040d4c12"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "91349a71-9e4b-4e4d-9b99-ceb0b9d0ebc6",
          "id": 1227,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Invoke QRadar REST API",
          "aliasName": null,
          "tag": "#qradar",
          "description": "Invokes a function to Get or Post an API endpoint on the QRadar server.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/f1b307fe-31db-46e2-9d52-ff32c9874471",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Invoke QRadar REST API",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "method": "GET"
                },
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "invoke_api",
                "operationTitle": "Invoke QRadar REST API",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "66eab293-866d-44eb-a4c7-979642fa072d"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "74f9dbc2-d106-4e97-9a26-ed647ed14ec8",
                "title": "IBM QRadar: Invoke QRadar REST API",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "f1b307fe-31db-46e2-9d52-ff32c9874471"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Invoke QRadar REST API",
              "targetStep": "/api/3/workflow_steps/66eab293-866d-44eb-a4c7-979642fa072d",
              "sourceStep": "/api/3/workflow_steps/f1b307fe-31db-46e2-9d52-ff32c9874471",
              "label": null,
              "isExecuted": false,
              "uuid": "7550d91b-1ab0-4b3b-8872-761adf1abd52"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "ad5884f3-6d4f-436a-9880-c19e0620e70b",
          "id": 1225,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Cases",
          "aliasName": null,
          "tag": "#qradar",
          "description": "Retrieves a detailed list of cases from Qradar based on input parameters specified",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/0b4aa341-a905-4026-8daa-2c158d13d0b8",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "02b4526e-4dad-46dc-8d01-579af90854b7",
                "title": "IBM QRadar: Get Cases",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "0b4aa341-a905-4026-8daa-2c158d13d0b8"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Cases",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "max_results": 100,
                  "filter_string": ""
                },
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "get_cases",
                "operationTitle": "Get Cases",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "7eccbb88-4a53-4a8e-b549-00f00c04600d"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Cases",
              "targetStep": "/api/3/workflow_steps/7eccbb88-4a53-4a8e-b549-00f00c04600d",
              "sourceStep": "/api/3/workflow_steps/0b4aa341-a905-4026-8daa-2c158d13d0b8",
              "label": null,
              "isExecuted": false,
              "uuid": "538394a5-a639-4eb8-bab0-dbbfc565540d"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "e68772b7-19fe-4bb4-8939-e6eb5cf0c5f0",
          "id": 1230,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Reference Tables",
          "aliasName": null,
          "tag": "#qradar",
          "description": "Retrieves a detailed list of reference tables from Qradar",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/42db0be6-48ee-4515-b5c3-81054694fccf",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "bb93e874-9527-47d7-8897-e7a4f71ef161",
                "title": "IBM QRadar: Get Reference Tables",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "42db0be6-48ee-4515-b5c3-81054694fccf"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Reference Tables",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "max_results": 100,
                  "filter_string": ""
                },
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "get_reference_tables",
                "operationTitle": "Get Reference Tables",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "88902d6c-17e2-47cc-81ec-1dcd5c0e4af5"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Reference Tables",
              "targetStep": "/api/3/workflow_steps/88902d6c-17e2-47cc-81ec-1dcd5c0e4af5",
              "sourceStep": "/api/3/workflow_steps/42db0be6-48ee-4515-b5c3-81054694fccf",
              "label": null,
              "isExecuted": false,
              "uuid": "bd8255af-8249-460b-b9b6-b5234aefb322"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "ea15d5d9-53a7-483c-a9fc-541e6e5ca74a",
          "id": 1232,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Table Elements",
          "aliasName": null,
          "tag": "#qradar",
          "description": "Retrieves the record details of a reference table defined by name from Qradar",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/26109d9f-8b56-46b7-a94a-0397bbc0118f",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Table Elements",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "path.name": "",
                  "max_results": 100
                },
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "get_table_elements",
                "operationTitle": "Get Table Elements",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "146f0451-7129-4859-8f4c-483c2ced509c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "dfd68241-52e2-4cca-8c5c-9966e9cbf87f",
                "title": "IBM QRadar: Get Table Elements",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "26109d9f-8b56-46b7-a94a-0397bbc0118f"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Table Elements",
              "targetStep": "/api/3/workflow_steps/146f0451-7129-4859-8f4c-483c2ced509c",
              "sourceStep": "/api/3/workflow_steps/26109d9f-8b56-46b7-a94a-0397bbc0118f",
              "label": null,
              "isExecuted": false,
              "uuid": "931174c3-dbcd-49e7-90bb-8ebd3dbaf6d1"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "eb9622aa-75a9-45e6-bacf-19fa433b2818",
          "id": 1234,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Delete/Purge Reference Table",
          "aliasName": null,
          "tag": "#qradar",
          "description": "Delete a reference table or purge its content on Qradar based on the input parameters specified.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/8ba693a5-6fc1-45d2-b5a7-edef15d6aa53",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "route": "3684e5bd-f984-4e42-9b28-d42edaba3180",
                "title": "IBM QRadar: Delete/Purge Reference Table",
                "resources": [
                  "alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                  "input": {
                    "records": "{{vars.input.records[0]}}"
                  }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": true,
                "singleRecordExecution": false
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
              "group": null,
              "uuid": "8ba693a5-6fc1-45d2-b5a7-edef15d6aa53"
            },
            {
              "@type": "WorkflowStep",
              "name": "Delete/Purge Reference Table",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "''",
                "params": {
                  "path.name": "",
                  "query.purge_only": "false"
                },
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "delete_reference_table",
                "operationTitle": "Delete/Purge Reference Table",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "e9fb3b17-b6a1-43fd-84b0-31569644378a"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Delete/Purge Reference Table",
              "targetStep": "/api/3/workflow_steps/e9fb3b17-b6a1-43fd-84b0-31569644378a",
              "sourceStep": "/api/3/workflow_steps/8ba693a5-6fc1-45d2-b5a7-edef15d6aa53",
              "label": null,
              "isExecuted": false,
              "uuid": "af24415f-14d6-4a0d-9e9d-1aec80a4bfbb"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "f3138c11-39ce-4efd-802c-0e3d49282b6c",
          "id": 1233,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "qradar"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "IBM QRadar > Post Create Alert > Fetch Events",
          "aliasName": null,
          "tag": "#qradar #dataingestion",
          "description": "Fetch events, source and destination ip address of an offense.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "qradar_timezone",
            "qradar_event_limit",
            "alertRecord"
          ],
          "synchronous": false,
          "lastModifyDate": 1674804960,
          "collection": "/api/3/workflow_collections/4415304c-9447-499a-9456-7c07e9acd2e1",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/d0c0c676-4150-466b-b015-6ac54095470e",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Fetch Events For an Offense",
              "description": null,
              "arguments": {
                "name": "IBM QRadar",
                "config": "",
                "params": {
                  "search_string": "SELECT  {{vars.event_query_params}} FROM EVENTS WHERE INOFFENSE({{vars.alertSourceData.offense_data['id']}}) ORDER BY starttime DESC LIMIT {{vars.event_record_limit}} START  '{{vars.offense_start_time}}' STOP '{{vars.current_time}}'"
                },
                "version": "1.6.0",
                "connector": "qradar",
                "operation": "query_qradar",
                "operationTitle": "Make an Ariel Query to QRadar",
                "step_variables": {
                  "offense_details": "{\n\"offense_data\": {{vars.alertSourceData.offense_data}},\n\"events_data\": {{vars.result.data.events}}\n}"
                }
              },
              "status": null,
              "top": "271",
              "left": "649",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "53f43e0b-7fc4-4046-b3f6-0154aa6b6dc7"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "current_time": "{{arrow.now(vars.input.params['qradar_timezone']).format('YYYY-MM-DD HH:mm:ss')}}",
                "event_query_params": "starttime,sourceip,destinationip,username,QIDNAME(qid) as 'Event_Name',CATEGORYNAME(category) AS 'Category_Name',LOGSOURCENAME(logsourceid) as 'Log_Source'",
                "event_record_limit": "{% if vars.input.params['qradar_event_limit']%}{{vars.input.params['qradar_event_limit']}}{% else %}50{% endif %}",
                "offense_start_time": "{{arrow.get((vars.alertSourceData.offense_data.start_time | int )/1000).to(vars.input.params['qradar_timezone']).format('YYYY-MM-DD HH:mm:ss')}}"
              },
              "status": null,
              "top": "200",
              "left": "340",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "9025b247-eb73-48d0-b2de-abee8c88fc0d"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Source Data",
              "description": null,
              "arguments": {
                "alertSourceData": "{{vars.input.params.alertRecord.sourcedata | from_json}}"
              },
              "status": null,
              "top": "111",
              "left": "189",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "b7421897-c3ef-4f78-ba9f-a032822fef8b"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Alert",
              "description": null,
              "arguments": {
                "resource": {
                  "sourcedata": "{{vars.offense_details | toJSON }}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.params.alertRecord['@id']}}",
                "__recommend": [],
                "collectionType": "/api/3/alerts",
                "fieldOperation": {
                  "recordTags": "Append"
                },
                "step_variables": []
              },
              "status": null,
              "top": "353",
              "left": "840",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "group": null,
              "uuid": "ccce10f5-0d36-4534-852d-1723554a5d3d"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "d0c0c676-4150-466b-b015-6ac54095470e"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Set Source Data -> Configuration",
              "targetStep": "/api/3/workflow_steps/9025b247-eb73-48d0-b2de-abee8c88fc0d",
              "sourceStep": "/api/3/workflow_steps/b7421897-c3ef-4f78-ba9f-a032822fef8b",
              "label": null,
              "isExecuted": false,
              "uuid": "283e8805-5b40-49b5-bac1-0f0db0f7af60"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Set Source Data",
              "targetStep": "/api/3/workflow_steps/b7421897-c3ef-4f78-ba9f-a032822fef8b",
              "sourceStep": "/api/3/workflow_steps/d0c0c676-4150-466b-b015-6ac54095470e",
              "label": null,
              "isExecuted": false,
              "uuid": "8099e879-2694-4ce1-a890-288cdf53889d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Fetch Events For an Offense",
              "targetStep": "/api/3/workflow_steps/53f43e0b-7fc4-4046-b3f6-0154aa6b6dc7",
              "sourceStep": "/api/3/workflow_steps/9025b247-eb73-48d0-b2de-abee8c88fc0d",
              "label": null,
              "isExecuted": false,
              "uuid": "973394a1-c59c-4ba2-b174-115b15efba73"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Events For an Offense -> Update Alert",
              "targetStep": "/api/3/workflow_steps/ccce10f5-0d36-4534-852d-1723554a5d3d",
              "sourceStep": "/api/3/workflow_steps/53f43e0b-7fc4-4046-b3f6-0154aa6b6dc7",
              "label": null,
              "isExecuted": false,
              "uuid": "a3c85d79-a1d1-45db-9f16-cef221dca439"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "fb724aae-4f4c-4bf5-a95b-f7eef4a80f61",
          "id": 1237,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "qradar"
          ]
        }
      ]
    }
  ],
  "exported_tags": [
    "qradar",
    "dataingestion",
    "fetch",
    "qradar app",
    "create",
    "ingest"
  ]
}